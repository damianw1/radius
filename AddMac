<?php
require_once 'config/DataBase.php';
require_once 'mac.php';
require_once 'department.php';


function AddMac($error, $mac, $hostname, $department, $vlan){
    $department_form = new department();
        
?>
<div id="mac">
    <h1>Dodawanie nowego adresu mac</h1>
    <form action="index.php?site=MacAdd" method="post">
        <table>
            <tr>
                <td>MAC</td>
                <td>
                <input name="mac" type="text" value="<?php echo $mac?>"/>
                </td>
            </tr>
            <tr>
                <td>Nazwa komputera</td>
                <td>
                <input name="hostname" type="text" size="50" value="<?php echo $hostname?>"/>
                </td>
            </tr>
             <tr>
                <td>VLAN</td>
                <td>
                <input name="vlan" type="text" size="5" value="<?php echo $vlan?>"/>
                </td>
            </tr>
            <tr>
                <td>Miejsce switch'a</td>
                <td>
                <select name="department">
                    <?php 
                   $department_form->getDepartment($department);
                     ?>
                </select>Nowe miejsce</td><td><input type="text" name="new_department" value=""/><input type="submit" name="Submit" value="Utwórz"></td>
                <input type="hidden" name="exec" value="true" /> 
            </tr>
            <tr>
                <td></td>
                <td>
                <input type="submit" name="Submit" value="Dodaj"/></td>
            </tr>
            
        </table>
        <?php echo $error?>
    </form>
</div>
<?php
}

if(isset($_POST['exec'])){
    
    switch ($_POST['Submit']) {
        case 'Utwórz':
            $department_new = new department();
            $add_Department = $department_new->addDepartment();
            if($add_Department==1){
            AddMac('Dodano nowy dział', "","","", "");
            }elseif($add_Department==2){
                AddMac('Wprowadź dział', "","","", "");
            }else{
                AddMac('Taki dział już istnieje', "","","", "");
            }
            
            break;
        
        case 'Dodaj':
            extract($_POST);
            $new_mac = new mac();    
            $add_mac = $new_mac->addMac($mac, $hostname, $department, $vlan);
            if($add_mac==1){
                AddMac("Mac został dodany", "", "",$department, "");
            }else{
                AddMac($add_mac, $mac, $hostname, $department, $vlan);
            }
            
                        
            break;
      }   
}else{
    AddMac("","","","","");
    
}



?>
